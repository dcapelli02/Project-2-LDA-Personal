ggplot(alz_long_rist, aes(x = year, y = taupet, group = patid,
color = sample, show.legend = FALSE)) +
geom_line(alpha = 1, show.legend = FALSE) +
theme_bw() +
labs(title = "TAUPET against year of measuring")
set.seed(3)
casual1 <- sample(1:length(alz$patid), 50)
alz_rist1 <- alz[casual1, ]
alz_rist1_df <- data.frame(alz_rist1)
alz_long_rist <- alz_rist1_df %>%
pivot_longer(
cols = matches("^(bprs|cdrsb_bin|abpet|taupet)\\d+$"),
names_to = c(".value", "year"),
names_pattern = "(bprs|cdrsb_bin|abpet|taupet)(\\d+)"
) %>%
mutate(
year = as.numeric(year),
sample = factor(rep(1:nrow(alz_rist1_df), each = 7)) # ID per ogni paziente
)
alz_long_rist$cdrsb <- alz_long_rist$cdrsb_bin
alz_long_rist$cdrsb_bin <- as.factor(alz_long_rist$cdrsb_bin)
ggplot(alz_long_rist, aes(x = year, y = cdrsb, group = patid,
color = sample, show.legend = FALSE)) +
geom_line(alpha = 1, show.legend = FALSE, size = 0.7) +
theme_bw() +
labs(title = "Time Evolution of CDRSB")
ggplot(alz_long_rist, aes(x = year, y = taupet, group = patid,
color = sample, show.legend = FALSE)) +
geom_line(alpha = 1, show.legend = FALSE) +
theme_bw() +
labs(title = "TAUPET against year of measuring")
set.seed(4)
casual1 <- sample(1:length(alz$patid), 50)
alz_rist1 <- alz[casual1, ]
alz_rist1_df <- data.frame(alz_rist1)
alz_long_rist <- alz_rist1_df %>%
pivot_longer(
cols = matches("^(bprs|cdrsb_bin|abpet|taupet)\\d+$"),
names_to = c(".value", "year"),
names_pattern = "(bprs|cdrsb_bin|abpet|taupet)(\\d+)"
) %>%
mutate(
year = as.numeric(year),
sample = factor(rep(1:nrow(alz_rist1_df), each = 7)) # ID per ogni paziente
)
alz_long_rist$cdrsb <- alz_long_rist$cdrsb_bin
alz_long_rist$cdrsb_bin <- as.factor(alz_long_rist$cdrsb_bin)
ggplot(alz_long_rist, aes(x = year, y = cdrsb, group = patid,
color = sample, show.legend = FALSE)) +
geom_line(alpha = 1, show.legend = FALSE, size = 0.7) +
theme_bw() +
labs(title = "Time Evolution of CDRSB")
ggplot(alz_long_rist, aes(x = year, y = taupet, group = patid,
color = sample, show.legend = FALSE)) +
geom_line(alpha = 1, show.legend = FALSE) +
theme_bw() +
labs(title = "TAUPET against year of measuring")
set.seed(5)
casual1 <- sample(1:length(alz$patid), 50)
alz_rist1 <- alz[casual1, ]
alz_rist1_df <- data.frame(alz_rist1)
alz_long_rist <- alz_rist1_df %>%
pivot_longer(
cols = matches("^(bprs|cdrsb_bin|abpet|taupet)\\d+$"),
names_to = c(".value", "year"),
names_pattern = "(bprs|cdrsb_bin|abpet|taupet)(\\d+)"
) %>%
mutate(
year = as.numeric(year),
sample = factor(rep(1:nrow(alz_rist1_df), each = 7)) # ID per ogni paziente
)
alz_long_rist$cdrsb <- alz_long_rist$cdrsb_bin
alz_long_rist$cdrsb_bin <- as.factor(alz_long_rist$cdrsb_bin)
ggplot(alz_long_rist, aes(x = year, y = cdrsb, group = patid,
color = sample, show.legend = FALSE)) +
geom_line(alpha = 1, show.legend = FALSE, size = 0.7) +
theme_bw() +
labs(title = "Time Evolution of CDRSB")
ggplot(alz_long_rist, aes(x = year, y = taupet, group = patid,
color = sample, show.legend = FALSE)) +
geom_line(alpha = 1, show.legend = FALSE) +
theme_bw() +
labs(title = "TAUPET against year of measuring")
set.seed(6)
casual1 <- sample(1:length(alz$patid), 50)
alz_rist1 <- alz[casual1, ]
alz_rist1_df <- data.frame(alz_rist1)
alz_long_rist <- alz_rist1_df %>%
pivot_longer(
cols = matches("^(bprs|cdrsb_bin|abpet|taupet)\\d+$"),
names_to = c(".value", "year"),
names_pattern = "(bprs|cdrsb_bin|abpet|taupet)(\\d+)"
) %>%
mutate(
year = as.numeric(year),
sample = factor(rep(1:nrow(alz_rist1_df), each = 7)) # ID per ogni paziente
)
alz_long_rist$cdrsb <- alz_long_rist$cdrsb_bin
alz_long_rist$cdrsb_bin <- as.factor(alz_long_rist$cdrsb_bin)
ggplot(alz_long_rist, aes(x = year, y = cdrsb, group = patid,
color = sample, show.legend = FALSE)) +
geom_line(alpha = 1, show.legend = FALSE, size = 0.7) +
theme_bw() +
labs(title = "Time Evolution of CDRSB")
ggplot(alz_long_rist, aes(x = year, y = taupet, group = patid,
color = sample, show.legend = FALSE)) +
geom_line(alpha = 1, show.legend = FALSE) +
theme_bw() +
labs(title = "TAUPET against year of measuring")
set.seed(7)
casual1 <- sample(1:length(alz$patid), 50)
alz_rist1 <- alz[casual1, ]
alz_rist1_df <- data.frame(alz_rist1)
alz_long_rist <- alz_rist1_df %>%
pivot_longer(
cols = matches("^(bprs|cdrsb_bin|abpet|taupet)\\d+$"),
names_to = c(".value", "year"),
names_pattern = "(bprs|cdrsb_bin|abpet|taupet)(\\d+)"
) %>%
mutate(
year = as.numeric(year),
sample = factor(rep(1:nrow(alz_rist1_df), each = 7)) # ID per ogni paziente
)
alz_long_rist$cdrsb <- alz_long_rist$cdrsb_bin
alz_long_rist$cdrsb_bin <- as.factor(alz_long_rist$cdrsb_bin)
ggplot(alz_long_rist, aes(x = year, y = cdrsb, group = patid,
color = sample, show.legend = FALSE)) +
geom_line(alpha = 1, show.legend = FALSE, size = 0.7) +
theme_bw() +
labs(title = "Time Evolution of CDRSB")
ggplot(alz_long_rist, aes(x = year, y = taupet, group = patid,
color = sample, show.legend = FALSE)) +
geom_line(alpha = 1, show.legend = FALSE) +
theme_bw() +
labs(title = "TAUPET against year of measuring")
set.seed(8)
casual1 <- sample(1:length(alz$patid), 50)
alz_rist1 <- alz[casual1, ]
alz_rist1_df <- data.frame(alz_rist1)
alz_long_rist <- alz_rist1_df %>%
pivot_longer(
cols = matches("^(bprs|cdrsb_bin|abpet|taupet)\\d+$"),
names_to = c(".value", "year"),
names_pattern = "(bprs|cdrsb_bin|abpet|taupet)(\\d+)"
) %>%
mutate(
year = as.numeric(year),
sample = factor(rep(1:nrow(alz_rist1_df), each = 7)) # ID per ogni paziente
)
alz_long_rist$cdrsb <- alz_long_rist$cdrsb_bin
alz_long_rist$cdrsb_bin <- as.factor(alz_long_rist$cdrsb_bin)
ggplot(alz_long_rist, aes(x = year, y = cdrsb, group = patid,
color = sample, show.legend = FALSE)) +
geom_line(alpha = 1, show.legend = FALSE, size = 0.7) +
theme_bw() +
labs(title = "Time Evolution of CDRSB")
ggplot(alz_long_rist, aes(x = year, y = taupet, group = patid,
color = sample, show.legend = FALSE)) +
geom_line(alpha = 1, show.legend = FALSE) +
theme_bw() +
labs(title = "TAUPET against year of measuring")
set.seed(9)
casual1 <- sample(1:length(alz$patid), 50)
alz_rist1 <- alz[casual1, ]
alz_rist1_df <- data.frame(alz_rist1)
alz_long_rist <- alz_rist1_df %>%
pivot_longer(
cols = matches("^(bprs|cdrsb_bin|abpet|taupet)\\d+$"),
names_to = c(".value", "year"),
names_pattern = "(bprs|cdrsb_bin|abpet|taupet)(\\d+)"
) %>%
mutate(
year = as.numeric(year),
sample = factor(rep(1:nrow(alz_rist1_df), each = 7)) # ID per ogni paziente
)
alz_long_rist$cdrsb <- alz_long_rist$cdrsb_bin
alz_long_rist$cdrsb_bin <- as.factor(alz_long_rist$cdrsb_bin)
ggplot(alz_long_rist, aes(x = year, y = cdrsb, group = patid,
color = sample, show.legend = FALSE)) +
geom_line(alpha = 1, show.legend = FALSE, size = 0.7) +
theme_bw() +
labs(title = "Time Evolution of CDRSB")
ggplot(alz_long_rist, aes(x = year, y = taupet, group = patid,
color = sample, show.legend = FALSE)) +
geom_line(alpha = 1, show.legend = FALSE) +
theme_bw() +
labs(title = "TAUPET against year of measuring")
set.seed(0)
casual1 <- sample(1:length(alz$patid), 50)
alz_rist1 <- alz[casual1, ]
alz_rist1_df <- data.frame(alz_rist1)
alz_long_rist <- alz_rist1_df %>%
pivot_longer(
cols = matches("^(bprs|cdrsb_bin|abpet|taupet)\\d+$"),
names_to = c(".value", "year"),
names_pattern = "(bprs|cdrsb_bin|abpet|taupet)(\\d+)"
) %>%
mutate(
year = as.numeric(year),
sample = factor(rep(1:nrow(alz_rist1_df), each = 7)) # ID per ogni paziente
)
alz_long_rist$cdrsb <- alz_long_rist$cdrsb_bin
alz_long_rist$cdrsb_bin <- as.factor(alz_long_rist$cdrsb_bin)
ggplot(alz_long_rist, aes(x = year, y = cdrsb, group = patid,
color = sample, show.legend = FALSE)) +
geom_line(alpha = 1, show.legend = FALSE, size = 0.7) +
theme_bw() +
labs(title = "Time Evolution of CDRSB")
ggplot(alz_long_rist, aes(x = year, y = taupet, group = patid,
color = sample, show.legend = FALSE)) +
geom_line(alpha = 1, show.legend = FALSE) +
theme_bw() +
labs(title = "TAUPET against year of measuring")
set.seed(1)
casual1 <- sample(1:length(alz$patid), 50)
alz_rist1 <- alz[casual1, ]
alz_rist1_df <- data.frame(alz_rist1)
alz_long_rist <- alz_rist1_df %>%
pivot_longer(
cols = matches("^(bprs|cdrsb_bin|abpet|taupet)\\d+$"),
names_to = c(".value", "year"),
names_pattern = "(bprs|cdrsb_bin|abpet|taupet)(\\d+)"
) %>%
mutate(
year = as.numeric(year),
sample = factor(rep(1:nrow(alz_rist1_df), each = 7)) # ID per ogni paziente
)
alz_long_rist$cdrsb <- alz_long_rist$cdrsb_bin
alz_long_rist$cdrsb_bin <- as.factor(alz_long_rist$cdrsb_bin)
ggplot(alz_long_rist, aes(x = year, y = cdrsb, group = patid,
color = sample, show.legend = FALSE)) +
geom_line(alpha = 1, show.legend = FALSE, size = 0.7) +
theme_bw() +
labs(title = "Time Evolution of CDRSB")
ggplot(alz_long_rist, aes(x = year, y = taupet, group = patid,
color = sample, show.legend = FALSE)) +
geom_line(alpha = 1, show.legend = FALSE) +
theme_bw() +
labs(title = "TAUPET against year of measuring")
library(haven)
library(dplyr)
library(tidyr)
library(ggplot2)
library(geepack)
library(lme4)
library(car)
library(lmtest)
library(MuMIn)
library(multgee)
library(ORTH.Ord)
alz <- read_sas("C:/Users/win11/Documents/Guillem/Erasmus/Assignatures/Longitudinal Data Analysis/Project-2-LDA-Personal/alzheimer25.sas7bdat")
alz$trial <- as.factor(alz$trial)
alz$sex <- as.factor(alz$sex)
alz$edu <- as.factor(alz$edu)
alz$job <- as.factor(alz$job)
alz$wzc <- as.factor(alz$wzc)
alz$adl <- as.factor(alz$adl)
alz$adl_num <- as.numeric(alz$adl)
alz$n_obs_data <- rowSums(!is.na(alz[, c(18:24)]))
alz$cdrsb_bin0 <- ifelse(alz$cdrsb0 > 10, 1, 0)
alz$cdrsb_bin1 <- ifelse(alz$cdrsb1 > 10, 1, 0)
alz$cdrsb_bin2 <- ifelse(alz$cdrsb2 > 10, 1, 0)
alz$cdrsb_bin3 <- ifelse(alz$cdrsb3 > 10, 1, 0)
alz$cdrsb_bin4 <- ifelse(alz$cdrsb4 > 10, 1, 0)
alz$cdrsb_bin5 <- ifelse(alz$cdrsb5 > 10, 1, 0)
alz$cdrsb_bin6 <- ifelse(alz$cdrsb6 > 10, 1, 0)
alz$ab_base <- alz$abpet0
alz$tau_base <- alz$taupet0
alz$cdrsb_base <- alz$cdrsb0
alz$bprs_base <- alz$bprs0
summary(alz)
alz_df <- data.frame(alz)
alz_long <- alz_df %>%
pivot_longer(
cols = matches("^(bprs|cdrsb_bin|abpet|taupet)\\d+$"),
names_to = c(".value", "year"),
names_pattern = "(bprs|cdrsb_bin|abpet|taupet)(\\d+)"
) %>%
mutate(
year = as.numeric(year),
sample = factor(rep(1:nrow(alz_df), each = 7))
)
alz_long$cdrsb <- alz_long$cdrsb_bin
alz_long$cdrsb_bin <- as.factor(alz_long$cdrsb_bin)
## Maybe any 5 years?
alz_long$age_disc <- (alz_long$age %/% 5) * 5
alz_long$age_disc <- as.factor(alz_long$age_disc)
## bmi any 4
alz_long$bmi_disc <- (alz_long$bmi %/% 4) * 4
alz_long$bmi_disc <- as.factor(alz_long$bmi_disc)
## inkomen any 500
alz_long$inkomen_disc <- (alz_long$inkomen %/% 500) * 500
alz_long$inkomen_disc <- as.factor(alz_long$inkomen_disc)
## adl any 5
alz_long$adl_disc <- (as.numeric(alz_long$adl) %/% 5) * 5
alz_long$adl_disc <- as.factor(alz_long$adl_disc)
## abpet any 0.2
alz_long$abpet_disc <- (alz_long$abpet %/% 0.2) * 0.2
alz_long$abpet_disc <- as.factor(alz_long$abpet_disc)
## taupet any 0.2
alz_long$taupet_disc <- (alz_long$taupet %/% 0.2) * 0.2
alz_long$taupet_disc <- as.factor(alz_long$taupet_disc)
## adl any 5
alz$adl_disc <- (as.numeric(alz$adl) %/% 5) * 5
alz$adl_disc <- as.factor(alz$adl_disc)
## year discrete
alz_long$year_seq <- ave(alz_long$year, alz_long$sample,
FUN = function(x) as.integer(factor(x)))
summary(alz_long)
# General Mean Behaviour
ggplot(alz_long, aes(x = year, y = cdrsb)) +
stat_summary(fun = mean, geom = "line", size = 1) +
stat_summary(fun.data = mean_sdl, geom = "ribbon", fun.args = list(mult = 1),
alpha = 0.2, fill = "lightblue") +
theme_minimal() +
labs(title = "General mean behavior with variance")
ggplot(alz_long, aes(x = year, y = cdrsb)) +
stat_summary(fun = mean, geom = "line", size = 1) +
#stat_summary(fun.data = mean_sdl, geom = "ribbon", fun.args = list(mult = 1),
#             alpha = 0.2, fill = "lightblue") +
theme_minimal() +
labs(title = "General mean behavior")
cat("Since this curve is not a straight line, we should  treat time as a factor.")
cat("We are allowing the model to estimate a different prob for each year.")
## SEX
ggplot(alz_long, aes(x = year, y = cdrsb, group = sex, color = sex)) +
stat_summary(fun = mean, geom = "line", size = 1) +
#stat_summary(fun.data = mean_sdl, geom = "ribbon", fun.args = list(mult = 1),
#             alpha = 0.2, fill = "lightblue") +
theme_minimal() +
labs(title = "General mean behavior wrt age_disc without variance")
## AGE
ggplot(alz_long, aes(x = year, y = cdrsb, group = age_disc, color = age_disc)) +
stat_summary(fun = mean, geom = "line", size = 1) +
#stat_summary(fun.data = mean_sdl, geom = "ribbon", fun.args = list(mult = 1),
#             alpha = 0.2, fill = "lightblue") +
theme_minimal() +
labs(title = "General mean behavior wrt age_disc without variance")
## BMI
ggplot(alz_long, aes(x = year, y = cdrsb, group = bmi_disc, color = bmi_disc)) +
stat_summary(fun = mean, geom = "line", size = 1) +
#stat_summary(fun.data = mean_sdl, geom = "ribbon", fun.args = list(mult = 1),
#             alpha = 0.2, fill = "lightblue") +
theme_minimal() +
labs(title = "General mean behavior wrt age_disc without variance")
## ADL
ggplot(alz_long, aes(x = year, y = cdrsb, group = adl_disc, color = adl_disc)) +
stat_summary(fun = mean, geom = "line", size = 1) +
#stat_summary(fun.data = mean_sdl, geom = "ribbon", fun.args = list(mult = 1),
#             alpha = 0.2, fill = "lightblue") +
theme_minimal() +
labs(title = "General mean behavior wrt age_disc without variance")
## AB
ggplot(alz_long, aes(x = year, y = cdrsb, group = abpet_disc, color = abpet_disc)) +
stat_summary(fun = mean, geom = "line", size = 1) +
#stat_summary(fun.data = mean_sdl, geom = "ribbon", fun.args = list(mult = 1),
#             alpha = 0.2, fill = "lightblue") +
theme_minimal() +
labs(title = "General mean behavior wrt age_disc without variance")
## TAU
ggplot(alz_long, aes(x = year, y = cdrsb, group = taupet_disc, color = taupet_disc)) +
stat_summary(fun = mean, geom = "line", size = 1) +
#stat_summary(fun.data = mean_sdl, geom = "ribbon", fun.args = list(mult = 1),
#             alpha = 0.2, fill = "lightblue") +
theme_minimal() +
labs(title = "General mean behavior wrt age_disc without variance")
cat("We see that the mean structure follows a logistic function.")
## CORRELATION
cor_matrix_cdrsb <- cor(alz[, c(11:17)], use = "pairwise.complete.obs")
round(cor_matrix_cdrsb, 2)
heatmap(cor_matrix_cdrsb, Rowv = NA, Colv = NA)
cat("We see that the first 3 measurements correlated with each other but not with the other last 4.")
cat("And the same happens with the last 4 measurement that are more correlated to each other than to the first.")
cat("Seeing the mean structure behaviour in the first years is lower, and in the last years it is higher.")
hist(alz$taupet0)
hist(alz$taupet1)
hist(alz$taupet2)
hist(alz$taupet3)
hist(alz$taupet4)
hist(alz$taupet5)
hist(alz$taupet6)
hist(alz$abpet0)
hist(alz$abpet1)
hist(alz$abpet2)
hist(alz$abpet3)
hist(alz$abpet4)
hist(alz$abpet5)
hist(alz$abpet6)
set.seed(1)
casual1 <- sample(1:length(alz$patid), 50)
alz_rist1 <- alz[casual1, ]
alz_rist1_df <- data.frame(alz_rist1)
alz_long_rist <- alz_rist1_df %>%
pivot_longer(
cols = matches("^(bprs|cdrsb_bin|abpet|taupet)\\d+$"),
names_to = c(".value", "year"),
names_pattern = "(bprs|cdrsb_bin|abpet|taupet)(\\d+)"
) %>%
mutate(
year = as.numeric(year),
sample = factor(rep(1:nrow(alz_rist1_df), each = 7)) # ID per ogni paziente
)
alz_long_rist$cdrsb <- alz_long_rist$cdrsb_bin
alz_long_rist$cdrsb_bin <- as.factor(alz_long_rist$cdrsb_bin)
ggplot(alz_long_rist, aes(x = year, y = cdrsb, group = patid,
color = sample, show.legend = FALSE)) +
geom_line(alpha = 1, show.legend = FALSE, size = 0.7) +
theme_bw() +
labs(title = "Time Evolution of CDRSB")
ggplot(alz_long_rist, aes(x = year, y = taupet, group = patid,
color = sample, show.legend = FALSE)) +
geom_line(alpha = 1, show.legend = FALSE) +
theme_bw() +
labs(title = "TAUPET against year of measuring")
cat("I have an observation, look that all patients dropout after their taupet increases just a little bit.")
cat("Maybe we could consider something about it.")
ggplot(alz_long_rist, aes(x = year, y = abpet, group = patid,
color = sample, show.legend = FALSE)) +
geom_line(alpha = 1, show.legend = FALSE) +
theme_bw() +
labs(title = "ABPET against year of measuring")
View(alz_long)
View(alz)
View(alz_clean)
hist(alz_clean$ab_base)
hist(alz_clean$tau_base)
View(alz_long)
View(alz_long_rist)
View(alz)
library(haven)
library(dplyr)
library(tidyr)
library(ggplot2)
library(geepack)
library(lme4)
library(car)
library(lmtest)
library(MuMIn)
library(multgee)
library(ORTH.Ord)
alz <- read_sas("C:/Users/win11/Documents/Guillem/Erasmus/Assignatures/Longitudinal Data Analysis/Project-2-LDA-Personal/alzheimer25.sas7bdat")
alz$trial <- as.factor(alz$trial)
alz$sex <- as.factor(alz$sex)
alz$edu <- as.factor(alz$edu)
alz$job <- as.factor(alz$job)
alz$wzc <- as.factor(alz$wzc)
alz$adl <- as.factor(alz$adl)
alz$adl_num <- as.numeric(alz$adl)
alz$n_obs_data <- rowSums(!is.na(alz[, c(18:24)]))
alz$cdrsb_bin0 <- ifelse(alz$cdrsb0 > 10, 1, 0)
alz$cdrsb_bin1 <- ifelse(alz$cdrsb1 > 10, 1, 0)
alz$cdrsb_bin2 <- ifelse(alz$cdrsb2 > 10, 1, 0)
alz$cdrsb_bin3 <- ifelse(alz$cdrsb3 > 10, 1, 0)
alz$cdrsb_bin4 <- ifelse(alz$cdrsb4 > 10, 1, 0)
alz$cdrsb_bin5 <- ifelse(alz$cdrsb5 > 10, 1, 0)
alz$cdrsb_bin6 <- ifelse(alz$cdrsb6 > 10, 1, 0)
alz$ab_base <- alz$abpet0
alz$tau_base <- alz$taupet0
alz$cdrsb_base <- alz$cdrsb0
alz$bprs_base <- alz$bprs0
summary(alz)
alz_df <- data.frame(alz)
alz_long <- alz_df %>%
pivot_longer(
cols = matches("^(bprs|cdrsb_bin|abpet|taupet)\\d+$"),
names_to = c(".value", "year"),
names_pattern = "(bprs|cdrsb_bin|abpet|taupet)(\\d+)"
) %>%
mutate(
year = as.numeric(year),
sample = factor(rep(1:nrow(alz_df), each = 7))
)
alz_long$cdrsb <- alz_long$cdrsb_bin
alz_long$cdrsb_bin <- as.factor(alz_long$cdrsb_bin)
## Maybe any 5 years?
alz_long$age_disc <- (alz_long$age %/% 5) * 5
alz_long$age_disc <- as.factor(alz_long$age_disc)
## bmi any 4
alz_long$bmi_disc <- (alz_long$bmi %/% 4) * 4
alz_long$bmi_disc <- as.factor(alz_long$bmi_disc)
## inkomen any 500
alz_long$inkomen_disc <- (alz_long$inkomen %/% 500) * 500
alz_long$inkomen_disc <- as.factor(alz_long$inkomen_disc)
## adl any 5
alz_long$adl_disc <- (as.numeric(alz_long$adl) %/% 5) * 5
alz_long$adl_disc <- as.factor(alz_long$adl_disc)
## abpet any 0.2
alz_long$abpet_disc <- (alz_long$abpet %/% 0.2) * 0.2
alz_long$abpet_disc <- as.factor(alz_long$abpet_disc)
## taupet any 0.2
alz_long$taupet_disc <- (alz_long$taupet %/% 0.2) * 0.2
alz_long$taupet_disc <- as.factor(alz_long$taupet_disc)
## adl any 5
alz$adl_disc <- (as.numeric(alz$adl) %/% 5) * 5
alz$adl_disc <- as.factor(alz$adl_disc)
## year discrete
alz_long$year_seq <- ave(alz_long$year, alz_long$sample,
FUN = function(x) as.integer(factor(x)))
summary(alz_long)
# General Mean Behaviour
ggplot(alz_long, aes(x = year, y = cdrsb)) +
stat_summary(fun = mean, geom = "line", size = 1) +
stat_summary(fun.data = mean_sdl, geom = "ribbon", fun.args = list(mult = 1),
alpha = 0.2, fill = "lightblue") +
theme_minimal() +
labs(title = "General mean behavior with variance")
ggplot(alz_long, aes(x = year, y = cdrsb)) +
stat_summary(fun = mean, geom = "line", size = 1) +
#stat_summary(fun.data = mean_sdl, geom = "ribbon", fun.args = list(mult = 1),
#             alpha = 0.2, fill = "lightblue") +
theme_minimal() +
labs(title = "General mean behavior")
